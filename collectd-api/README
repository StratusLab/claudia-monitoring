This code is extracted from collectd 5.0.0. It is only mavenized.
